{"version":3,"sources":["/script/modules/trackcontrol/views/monitoronlinecontent.js"],"names":[],"mappings":"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","file":"/script/modules/trackcontrol/views/monitoronlinecontent.js","sourcesContent":["/**\r\n * @file 实时监控离线 Reflux View\r\n * @author 崔健 cuijian03@baidu.com 2016.08.23\r\n */\r\nimport React, { Component } from 'react'\r\nimport { render } from 'react-dom'\r\nimport TrackStore from '../stores/trackStore'\r\nimport CommonStore from '../../common/stores/commonStore'\r\nimport MonitorOnlinePage from 'monitoronlinepage'\r\nimport TrackAction from '../actions/trackAction'\r\n\r\nvar Monitoronlinecontent = React.createClass({\r\n    getInitialState: function() {\r\n        return {\r\n            // 页签编码 0为实时监控 1为轨迹查询\r\n            tabIndex: 0,\r\n            // monitor三种列表类型编码 0全部 1在线 2离线\r\n            monitorTabIndex: 0,\r\n            // 父容器可见性\r\n            parentVisible: {},\r\n            // 当前列表内容\r\n            allEntity: [],\r\n            // 当前选中的entityname\r\n            currentEntityName: ''\r\n        }\r\n    },\r\n    componentDidMount: function () {\r\n        TrackStore.listen(this.onStatusChange);\r\n        CommonStore.listen(this.onStatusChange);\r\n        // TrackAction.listcolumn();\r\n    }, \r\n    onStatusChange: function (type,data) {\r\n        switch (type){\r\n            case 'switchmanagetab':\r\n                this.listenSwitchmanageTab(data);\r\n            break;\r\n            case 'switchtab':\r\n                this.listenSwitchTab(data);\r\n            break;\r\n            case 'switchmonitortab':\r\n                this.listenSwitchMonitorTab(data);\r\n            break;\r\n            case 'listcolumn':\r\n                this.listenListColumn();\r\n            break;\r\n            case 'onlinelist':\r\n                this.listenOnlineList(data);\r\n            break;\r\n        }\r\n    },\r\n    /**\r\n     * 响应Store list事件，设置标签页\r\n     *\r\n     * @param {data} 标签页标识\r\n     */\r\n    listenSwitchmanageTab: function(data) {\r\n        var that = this;\r\n        if (data === 0){\r\n            this.setState({parentVisible: {}});\r\n        } else {\r\n            this.setState({parentVisible: {visibility: 'inherit'}});\r\n        }\r\n    },\r\n    /**\r\n     * 响应Store switchtab事件，隐藏manage\r\n     *\r\n     * @param {data} 标签页标识\r\n     */\r\n    listenSwitchTab: function(data) {\r\n        var that = this;\r\n        if (data === 0){\r\n            switch (that.state.monitorTabIndex) {\r\n                case 0:\r\n                    this.setState({parentVisible: {}});\r\n                break;\r\n                case 1:\r\n                    this.setState({parentVisible: {visibility: 'inherit'}});\r\n                break;\r\n                case 2:\r\n                    this.setState({parentVisible: {}});\r\n                break;\r\n            }        \r\n            this.setState({tabIndex: 0});\r\n        } else {\r\n            this.setState({parentVisible: {visibility: 'inherit'}});\r\n            this.setState({tabIndex: 1});\r\n        }\r\n    },\r\n    /**\r\n     * 响应Store switchmonitortab事件,设置标签页\r\n     *\r\n     * @param {data} 标签页标识\r\n     */\r\n    listenSwitchMonitorTab: function(data) {\r\n        this.setState({parentVisible: {}});\r\n        this.setState({monitorTabIndex: data});\r\n    },\r\n    /**\r\n     * 响应Store listcolumn事件,设置标签页\r\n     *\r\n     */\r\n    listenListColumn: function() {\r\n        TrackAction.searchonlineentity(1);\r\n    },\r\n    /**\r\n     * 响应Store onlinelist事件,设置列表\r\n     *\r\n     * @param {data} entity数据\r\n     */\r\n    listenOnlineList: function(data) {\r\n        this.setState({allEntity:data});\r\n    },\r\n    /**\r\n     * DOM操作回调，点击选中一辆车\r\n     *\r\n     * @param {object} event 事件对象 \r\n     */\r\n    handleSelectCar: function(event) {\r\n        var realTarget = event.target;\r\n        if (event.target.parentElement.className.indexOf('monitorListItem') > -1) {\r\n            realTarget = event.target.parentElement;\r\n        }\r\n        if (event.target.parentElement.parentElement.className.indexOf('monitorListItem') > -1) {\r\n            realTarget = event.target.parentElement.parentElement;\r\n        }\r\n        var entity_name = realTarget.getAttribute('data-entity_name');\r\n        var entity_status = realTarget.getAttribute('data-entity_status');\r\n        // $('.monitorListItem0, .monitorListItem1, .monitorListItem2').removeClass('monitorSelect');\r\n        // $(realTarget).addClass('monitorSelect');\r\n        var entity_id = realTarget.getAttribute('data-entity_id');\r\n        this.setState({currentEntityName: entity_name});\r\n        TrackAction.selectcar(entity_name, entity_status, entity_id, 'onlineCompleteEntities');\r\n    },\r\n    render: function() {\r\n        var monitorTabIndex = this.state.monitorTabIndex;\r\n        var parentVisible = this.state.parentVisible;\r\n        var allEntity = this.state.allEntity;\r\n        var handleSelectCar = this.handleSelectCar;\r\n        var currentEntityName = this.state.currentEntityName;\r\n        return (\r\n            <div className={monitorTabIndex === 1 ? 'monitorOnlineContent visible' : 'monitorOnlineContent hidden'} style={parentVisible} >\r\n                    <div className=\"monitorFrame\">\r\n                    {\r\n                        allEntity.map(function(item, key) {\r\n                            return (\r\n                                <div className={'monitorListItem' + item[2] + ((currentEntityName === item[0]) ? ' monitorSelect' : '')} key={key} data-entity_name={item[0]} data-entity_status={item[2]} data-entity_id={item[3]} onClick={handleSelectCar}>\r\n                                    <div className=\"monitorListItemName\"><abbr title={item[5]}>{item[5]}</abbr></div>\r\n                                    <div className=\"monitorListItemSpeed\">{item[1]}</div>\r\n                                </div>\r\n                                )\r\n                        })\r\n                    }\r\n                    </div>\r\n                <MonitorOnlinePage />\r\n            </div>\r\n\r\n        )\r\n    }\r\n});\r\n\r\nexport default Monitoronlinecontent;\r\n"]}