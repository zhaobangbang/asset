{"version":3,"sources":["/script/common/mapControl.js"],"names":[],"mappings":"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","file":"/script/common/mapControl.js","sourcesContent":["/* globals BMap */\r\n/* globals map */\r\n/* globals BMapLib */\r\n/* globals mapv */\r\n/* globals dataSet */\r\n/* eslint-disable fecs-camelcase */\r\n/**\r\n * @file 初始化地图样式和组件\r\n * @author 崔健 cuijian03@baidu.com 2016.08.22\r\n */\r\n\r\n// import ZoomControl from 'zoomControl'\r\nimport TrackAction from '../modules/trackcontrol/actions/trackAction';\r\n\r\nwindow.mapControl = {\r\n    /**\r\n     * 初始化地图\r\n     *\r\n     */\r\n    initMap: function() {\r\n        let that = this;\r\n        let infoBoxScript = document.createElement('script');\r\n        infoBoxScript.src = 'http://api.map.baidu.com/library/InfoBox/1.2/src/InfoBox_min.js';\r\n        document.getElementsByTagName('head')[0].appendChild(infoBoxScript);\r\n        let canvasScript = document.createElement('script');\r\n        canvasScript.src = __uri('/static/javascript/CanvasLayer.js');\r\n        document.getElementsByTagName('head')[0].appendChild(canvasScript);\r\n        let mapvScript = document.createElement('script');\r\n        mapvScript.src = 'http://mapv.baidu.com/build/mapv.js';\r\n        document.getElementsByTagName('head')[0].appendChild(mapvScript);\r\n        mapvScript.onload = function () {\r\n            that.initBoundsearch();\r\n        };\r\n        window.map = new BMap.Map(\"mapContainer\", {enableMapClick: false});    // 创建Map实例\r\n        map.centerAndZoom(new BMap.Point(116.404, 39.915), 10);  // 初始化地图,设置中心点坐标和地图级别\r\n        map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放\r\n        this.initLocation();\r\n        this.initControl();\r\n        this.initOverlay();\r\n    },\r\n\r\n    initBoundsearch() {\r\n        map.addEventListener('zoomend', function () {\r\n            TrackAction.boundsearchentity();\r\n        });\r\n        map.addEventListener('moveend', function () {\r\n            TrackAction.boundsearchentity();\r\n        });\r\n        map.addEventListener('movestart', function () {\r\n        });\r\n    },\r\n    /**\r\n     * 根据浏览器定位确定地图位置\r\n     *\r\n     */\r\n    initLocation: function() {\r\n        var geolocation = new BMap.Geolocation();\r\n        geolocation.getCurrentPosition(function(r){\r\n            if(this.getStatus() == BMAP_STATUS_SUCCESS){\r\n                map.panTo(r.point);\r\n            }\r\n            else {\r\n                \r\n            }        \r\n        },\r\n        {\r\n            enableHighAccuracy: true\r\n        });\r\n    },\r\n    /**\r\n     * 添加控件\r\n     *\r\n     */\r\n    initControl: function() {\r\n        this.addCityListControl();\r\n        this.addZoomControl();\r\n        this.initTrafficControl();\r\n        this.addMapTypeControl();\r\n        this.initSpeedControl();\r\n        this.showTrafficControl();\r\n    },\r\n    /**\r\n     * 初始化自定义覆盖物\r\n     *\r\n     */\r\n    initOverlay: function() {\r\n        this.initBehaviorOverlay();\r\n        this.initTrackPointOverlay();\r\n    },\r\n    /**\r\n     * 添加城市列表控件\r\n     *\r\n     */\r\n    addCityListControl: function() {\r\n        var size = new BMap.Size(360, 72);\r\n        map.addControl(new BMap.CityListControl({\r\n            anchor: BMAP_ANCHOR_TOP_LEFT,\r\n            offset: size\r\n        }));\r\n    },\r\n    /**\r\n    * 添加缩放控件\r\n    *\r\n    */\r\n    addZoomControl: function() {\r\n        /**\r\n         * 自定义缩放控件\r\n         *\r\n         */\r\n        var ZoomControl = function (){\r\n            // 默认停靠位置和偏移量\r\n            this.defaultAnchor = BMAP_ANCHOR_BOTTOM_RIGHT;\r\n            this.defaultOffset = new BMap.Size(15, 90);\r\n        }\r\n\r\n        // 通过JavaScript的prototype属性继承于BMap.Control\r\n        ZoomControl.prototype = new BMap.Control();\r\n\r\n        // 自定义控件必须实现自己的initialize方法,并且将控件的DOM元素返回\r\n        // 在本方法中创建个div元素作为控件的容器,并将其添加到地图容器中\r\n        ZoomControl.prototype.initialize = function(map){\r\n            var zoom = document.createElement(\"div\");\r\n            zoom.className = 'zoom';\r\n            var zoomIn = document.createElement(\"div\");\r\n            zoomIn.className = 'zoomIn';\r\n            var zoomOut = document.createElement(\"div\");\r\n            zoomOut.className = 'zoomOut';\r\n            zoom.appendChild(zoomIn);\r\n            zoom.appendChild(zoomOut);\r\n            zoomIn.onclick = function (e) {\r\n                map.zoomIn();\r\n            };\r\n            zoomOut.onclick = function (e) {\r\n                map.zoomOut();\r\n            }\r\n            // 添加DOM元素到地图中\r\n            map.getContainer().appendChild(zoom);\r\n            // 将DOM元素返回\r\n            return zoom;\r\n        }\r\n\r\n        // 创建控件\r\n        var myZoomCtrl = new ZoomControl();\r\n        // 添加到地图当中\r\n        map.addControl(myZoomCtrl);\r\n    },\r\n    /**\r\n    * 添加交通流量控件\r\n    *\r\n    */\r\n    initTrafficControl: function() {\r\n        var trafficLayer;\r\n        /**\r\n         * 自定义交通流量控件\r\n         *\r\n         */\r\n        this.TrafficControl = function (){\r\n            // 默认停靠位置和偏移量\r\n            this.defaultAnchor = BMAP_ANCHOR_BOTTOM_RIGHT;\r\n            this.defaultOffset = new BMap.Size(15, 197);\r\n        }\r\n\r\n        // 通过JavaScript的prototype属性继承于BMap.Control\r\n        this.TrafficControl.prototype = new BMap.Control();\r\n\r\n        // 自定义控件必须实现自己的initialize方法,并且将控件的DOM元素返回\r\n        // 在本方法中创建个div元素作为控件的容器,并将其添加到地图容器中\r\n        this.TrafficControl.prototype.initialize = function(map){\r\n            var traffic = document.createElement(\"div\");\r\n            traffic.className = 'trafficOn';\r\n            traffic.onclick = function (e) {\r\n                if (traffic.className.indexOf('trafficOn') > -1) {\r\n                    trafficLayer = new BMap.TrafficLayer();\r\n                    map.addTileLayer(trafficLayer);\r\n                    traffic.className = traffic.className.replace(/trafficOn/, 'trafficOff');\r\n                } else {\r\n                    map.removeTileLayer(trafficLayer);\r\n                    traffic.className = traffic.className.replace(/trafficOff/, 'trafficOn');\r\n                }\r\n            };\r\n            // 添加DOM元素到地图中\r\n            map.getContainer().appendChild(traffic);\r\n            // 将DOM元素返回\r\n            return traffic;\r\n        }\r\n\r\n    },\r\n    /**\r\n    * 添加地图类型控件\r\n    *\r\n    */\r\n    addMapTypeControl: function() {\r\n        /**\r\n         * 自定义交通流量控件\r\n         *\r\n         */\r\n        var MapTypeControl = function (){\r\n            // 默认停靠位置和偏移量\r\n            this.defaultAnchor = BMAP_ANCHOR_BOTTOM_RIGHT;\r\n            this.defaultOffset = new BMap.Size(15, 159);\r\n        }\r\n\r\n        // 通过JavaScript的prototype属性继承于BMap.Control\r\n        MapTypeControl.prototype = new BMap.Control();\r\n\r\n        // 自定义控件必须实现自己的initialize方法,并且将控件的DOM元素返回\r\n        // 在本方法中创建个div元素作为控件的容器,并将其添加到地图容器中\r\n        MapTypeControl.prototype.initialize = function(map){\r\n            var mapType = document.createElement(\"div\");\r\n            mapType.className = 'earth';\r\n            mapType.onclick = function (e) {\r\n                if (mapType.className.indexOf('earth') > -1) {\r\n                    map.setMapType(BMAP_HYBRID_MAP);\r\n                    mapType.className = mapType.className.replace(/earth/, 'normal');\r\n                } else {\r\n                    map.setMapType(BMAP_NORMAL_MAP); \r\n                    mapType.className = mapType.className.replace(/normal/, 'earth');\r\n                }\r\n            };\r\n            // 添加DOM元素到地图中\r\n            map.getContainer().appendChild(mapType);\r\n            // 将DOM元素返回\r\n            return mapType;\r\n        }\r\n\r\n        // 创建控件\r\n        var myMapTypeCtrl = new MapTypeControl();\r\n        // 添加到地图当中\r\n        map.addControl(myMapTypeCtrl);\r\n    },\r\n    /**\r\n    * 初始化速度标识控件\r\n    *\r\n    */\r\n    initSpeedControl: function() {\r\n        /**\r\n         * 自定义速度空间\r\n         *\r\n         */\r\n        this.SpeedControl = function (){\r\n            // 默认停靠位置和偏移量\r\n            this.defaultAnchor = BMAP_ANCHOR_BOTTOM_RIGHT;\r\n            this.defaultOffset = new BMap.Size(15, 235);\r\n        }\r\n\r\n        // 通过JavaScript的prototype属性继承于BMap.Control\r\n        this.SpeedControl.prototype = new BMap.Control();\r\n\r\n        // 自定义控件必须实现自己的initialize方法,并且将控件的DOM元素返回\r\n        // 在本方法中创建个div元素作为控件的容器,并将其添加到地图容器中\r\n        this.SpeedControl.prototype.initialize = function(map){\r\n            var speedControl = document.createElement(\"div\");\r\n            speedControl.className = 'speedControl';\r\n            \r\n            // 添加DOM元素到地图中\r\n            map.getContainer().appendChild(speedControl);\r\n            // 将DOM元素返回\r\n            return speedControl;\r\n        }\r\n    },\r\n    /**\r\n    * 显示速度控件\r\n    *\r\n    */\r\n    showSpeedControl: function() {\r\n         // 创建控件\r\n        this.mySpeedControl = new this.SpeedControl();\r\n        // 添加到地图当中\r\n        map.addControl(this.mySpeedControl);\r\n    },\r\n    /**\r\n    * 删除速度控件\r\n    *\r\n    */\r\n    removeSpeedControl: function() {\r\n        map.removeControl(this.mySpeedControl);\r\n    },\r\n    /**\r\n    * 显示路况控件\r\n    *\r\n    */\r\n    showTrafficControl: function() {\r\n        // 创建控件\r\n        this.myTrafficCtrl = new this.TrafficControl();\r\n        // 添加到地图当中\r\n        map.addControl(this.myTrafficCtrl);\r\n    },\r\n    /**\r\n    * 删除路况控件\r\n    *\r\n    */\r\n    removeTrafficControl: function() {\r\n        map.removeControl(this.myTrafficCtrl);\r\n    },\r\n    /**\r\n    * 添加驾驶行为覆盖物\r\n    *\r\n    */\r\n    addBehaviorOverlay: function(point, type, data) {\r\n        var myCompOverlay = new this.behaviorOverlay(point, type, data);\r\n        map.addOverlay(myCompOverlay);\r\n    },\r\n    /**\r\n    * 删除驾驶行为覆盖物\r\n    *\r\n    */\r\n    removeBehaviorOverlay: function() {\r\n        var overlays = map.getOverlays();\r\n        var length = overlays.length;\r\n        var behaviorOverlays = [];\r\n        for(var i = 0; i < length; i++) {\r\n            if(overlays[i].type === 'behavior') {\r\n                behaviorOverlays.push(overlays[i]);\r\n            }\r\n        }\r\n        for(var j = 0; j < behaviorOverlays.length; j++) {\r\n            map.removeOverlay(behaviorOverlays[j]);\r\n        }\r\n    },\r\n    /**\r\n     *\r\n     * 设置驾驶行为覆盖物可见性\r\n     * @param {array} data 驾驶行为可见配置\r\n     */\r\n    updataBehaviorDisplay: function(data) {\r\n        var overlays = map.getOverlays();\r\n        for (var j = 0; j < overlays.length; j++) {\r\n            switch (overlays[j]._type) {\r\n                case 'behaviorPlace':\r\n                    if(data[3] === '0') {\r\n                        overlays[j].hide();\r\n                    } else {\r\n                        overlays[j].show();\r\n                    }\r\n                break;\r\n                case 'behaviorAccelecation':\r\n                case 'behaviorBreaking':\r\n                    if(data[1] === '0') {\r\n                        overlays[j].hide();\r\n                    } else {\r\n                        overlays[j].show();\r\n                    }\r\n                break;\r\n                case 'behaviorSteering':\r\n                    if(data[2] === '0') {\r\n                        overlays[j].hide();\r\n                    } else {\r\n                        overlays[j].show();\r\n                    }\r\n                break;\r\n                case 'behaviorSpeeking':\r\n                    if(data[0] === '0') {\r\n                        overlays[j].hide();\r\n                    } else {\r\n                        overlays[j].show();\r\n                    }\r\n                break;\r\n            }\r\n            \r\n        }\r\n\r\n    },\r\n    /**\r\n     * 初始化驾驶行为覆盖物\r\n     *\r\n     */\r\n    initBehaviorOverlay: function() {\r\n        this.behaviorOverlay = function(point, type, data) {\r\n            this._point = point;\r\n            this._type = type;\r\n            this._data = data;\r\n            this.type = 'behavior';\r\n        }\r\n        this.behaviorOverlay.prototype = new BMap.Overlay();\r\n        this.behaviorOverlay.prototype.initialize = function(map){\r\n            var that = this;\r\n            this._map = map;\r\n            var div = this._div = document.createElement(\"div\");\r\n            div.className = 'behaviorOverlay ' + this._type;\r\n\r\n            var text = document.createTextNode(that._data);\r\n            div.appendChild(text);\r\n            \r\n            div.onmouseover = function(){\r\n                switch (that._type) {\r\n                    case 'behaviorPlace':\r\n                        div.style.width = '120px';\r\n                    break;\r\n                    case 'behaviorSpeeking':\r\n                        div.style.width = '142px'\r\n                    break;\r\n                    case 'behaviorSteering':\r\n                    case 'behaviorAccelecation':\r\n                    case 'behaviorBreaking':\r\n                        div.style.width = '65px';\r\n                    break\r\n                }\r\n\r\n                div.style.boxShadow = \"0px 3px 3px #bcbcbb\";\r\n\r\n            }\r\n\r\n            div.onmouseout = function(){\r\n                div.style.width = '20px';\r\n                div.style.boxShadow = \"\";\r\n            }\r\n\r\n            map.getPanes().labelPane.appendChild(div);\r\n            \r\n            return div;\r\n        }\r\n        this.behaviorOverlay.prototype.draw = function(){\r\n            var map = this._map;\r\n            var pixel = map.pointToOverlayPixel(this._point);\r\n            this._div.style.left = pixel.x - 10 + \"px\";\r\n            this._div.style.top  = pixel.y  - 10 + \"px\";\r\n        }\r\n        // 实现显示方法    \r\n        this.behaviorOverlay.prototype.show = function(){    \r\n         if (this._div){    \r\n           this._div.style.display = \"\";    \r\n         }    \r\n        }      \r\n        // 实现隐藏方法  \r\n        this.behaviorOverlay.prototype.hide = function(){    \r\n         if (this._div){    \r\n           this._div.style.display = \"none\";    \r\n         }    \r\n        }\r\n    },\r\n\r\n    /**\r\n     * 初始化轨迹点信息覆盖物\r\n     *\r\n     */\r\n    initTrackPointOverlay() {\r\n        this.trackPointOverlay = function (point, type) {\r\n            this._point = point;\r\n            // this.type = 'trackpoint';\r\n            this.type = type;\r\n        };\r\n        this.trackPointOverlay.prototype = new BMap.Overlay();\r\n        this.trackPointOverlay.prototype.initialize = function (map) {\r\n            let that = this;\r\n            this._map = map;\r\n            let div = this._div = document.createElement('div');\r\n            // div.className = 'trackpointOverlay';\r\n            div.className = this.type;\r\n            let innerDiv = document.createElement('div');\r\n            innerDiv.className = 'trackpoint_in';\r\n            div.appendChild(innerDiv);\r\n            map.getPanes().labelPane.appendChild(div);\r\n            return div;\r\n        };\r\n        this.trackPointOverlay.prototype.draw = function () {\r\n            let map = this._map;\r\n            let pixel = map.pointToOverlayPixel(this._point);\r\n            this._div.style.left = pixel.x - 8 + 'px';\r\n            this._div.style.top  = pixel.y  - 8 + 'px';\r\n        };\r\n    },\r\n\r\n    /**\r\n     * 添加轨迹点信息覆盖物\r\n     *\r\n     * @param {Object} point 点\r\n     * @param {string} type 点类型\r\n     */\r\n    addTrackPointOverlay(point, type) {\r\n        let myCompOverlay = new this.trackPointOverlay(point, type);\r\n        map.addOverlay(myCompOverlay);\r\n    },\r\n\r\n    /**\r\n    * 删除轨迹点信息覆盖物\r\n    *\r\n    * @param {string} type 类型，分为鼠标浮动和点击两种\r\n    */\r\n    removeTrackPointOverlay(type) {\r\n        let overlays = map.getOverlays();\r\n        let length = overlays.length;\r\n        let trackPointOverlays = [];\r\n        for (let i = 0; i < length; i++) {\r\n            if (overlays[i].type === type) {\r\n                trackPointOverlays.push(overlays[i]);\r\n            }\r\n        }\r\n        for (let j = 0; j < trackPointOverlays.length; j++) {\r\n            map.removeOverlay(trackPointOverlays[j]);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 初始化车辆信息详情和轨迹点详情infobox\r\n     *\r\n     * @param {Object} data 数据\r\n     */\r\n    setMonitorInfoBox(data) {\r\n        let infoContentFrontArr = [\r\n            '<div class=\"carInfoWindow\">',\r\n                '<div class=\"carInfoHeader' + data.entity_status + '\">',\r\n                    '<abbr title=\"' + data.entity_print + '\">',\r\n                    data.entity_print,\r\n                    '</abbr>',\r\n                '</div>',\r\n                '<div class=\"carInfoContent\">'\r\n        ];\r\n        data.infor.map(function (item) {\r\n            let itemPushArr = [\r\n                '<div class=\"carInfoItem\">',\r\n                    '<div class=\"infoItemTitle\">',\r\n                        item[0],\r\n                    '</div>',\r\n                    '<div class=\"infoItemContent\">',\r\n                        item[1],\r\n                    '</div>',\r\n                '</div>'\r\n            ];\r\n            infoContentFrontArr.push(itemPushArr.join(''));\r\n        });\r\n        let infoContentNextArr = [\r\n            '</div>',\r\n            '<div class=\"infoControl\">',\r\n                '<div class=\"infoZoomIn\" id=\"monitorInfoZoomIn\">',\r\n                    '放大',\r\n                '</div>',\r\n            '</div>',\r\n            '</div>'\r\n        ];\r\n        this.monitorInfoBox = new BMapLib.InfoBox(\r\n            map,\r\n            infoContentFrontArr.concat(infoContentNextArr).join(''),\r\n            {\r\n                boxClass: 'carInfoBox',\r\n                // boxStyle:{background:\"url('tipbox.gif') no-repeatcenter top\",width: \"200px\"},\r\n                closeIconMargin: '15px 20px 0 0',\r\n                alignBottom: false,\r\n                closeIconUrl: __uri('/static/images/closeinfowindow.png')\r\n            }\r\n        );\r\n        this.monitorInfoBox.addEventListener('close', function (e) {\r\n            TrackAction.closemonitorinfobox();\r\n        });\r\n        this.monitorInfoBox.open(this.entityMarker);\r\n        $('#monitorInfoZoomIn').click(function (e) {\r\n            // this.monitorInfoBox.hide();\r\n            map.zoomIn();\r\n            map.addEventListener('moveend', function () {\r\n                // that.monitorInfoBox.show();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * 删除infobox\r\n     *\r\n     */\r\n    removeMonitorInfoBox() {\r\n        map.removeOverlay(this.monitorInfoBox);\r\n        this.monitorInfoBox = null;\r\n    },\r\n\r\n    /**\r\n     * 设置设备监控的marker\r\n     *\r\n     * @param {Object} data marker的数据信息\r\n     * @param {number} service_type 服务类型\r\n     */\r\n    setEntityMarker(data, service_type) {\r\n        let that = this;\r\n        let point = new BMap.Point(data.point[0], data.point[1]);\r\n        let iconUrl = '';\r\n        let size;\r\n        let imageSize;\r\n        let status = data.status;\r\n        if (service_type === 1) {\r\n            size = new BMap.Size(41, 34);\r\n            imageSize = new BMap.Size(41, 34);\r\n            switch (status.substring(0, 2)) {\r\n                case '离线':\r\n                    iconUrl = __uri('/static/images/caroffnorth.png');\r\n                    break;\r\n                case '静止':\r\n                    iconUrl = __uri('/static/images/carstaticnorth.png');\r\n                    break;\r\n                default:\r\n                    iconUrl = __uri('/static/images/carrunnorth.png');\r\n                    break;\r\n            }\r\n        } else {\r\n            size = new BMap.Size(22, 27);\r\n            imageSize = new BMap.Size(22, 27);\r\n            switch (status.substring(0, 2)) {\r\n                case '离线':\r\n                    iconUrl = __uri('/static/images/othertypeoffline.png');\r\n                    break;\r\n                case '静止':\r\n                    iconUrl = __uri('/static/images/othertypestatic.png');\r\n                    break;\r\n                default:\r\n                    iconUrl = __uri('/static/images/othertype.png');\r\n                    break;\r\n            }\r\n        }\r\n        let icon = new BMap.Icon(iconUrl, size);\r\n        icon.setImageSize(imageSize);\r\n        this.entityMarker = new BMap.Marker(point, {icon: icon});\r\n        this.entityMarker.setRotation(data.direction);\r\n        this.entityMarker.addEventListener('click', function (e) {\r\n            that.monitorInfoBox.open(that.entityMarker);\r\n        });\r\n        map.addOverlay(this.entityMarker);\r\n        // 如果是定时器触发的，那么不移动地图\r\n        if (!data.interval) {\r\n            map.panTo(point);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 根据entity的类型和状态获取图标\r\n     *\r\n     * @param {number} type service类型\r\n     * @param {Object} data entity的数据\r\n     * @return {string} entity的icon地址\r\n     */\r\n    getEntityIcon(type, data) {\r\n        let img = new Image();\r\n        let iconUrl = '';\r\n        let height = 0;\r\n        let width = 0;\r\n        // console.log(data);\r\n        let status = data.status;\r\n        if (type === 1) {\r\n            height = 41;\r\n            width = 34;\r\n            switch (status) {\r\n                case '离线':\r\n                    iconUrl = __uri('/static/images/caroffnorth.png');\r\n                    break;\r\n                case '静止':\r\n                    iconUrl = __uri('/static/images/carstaticnorth.png');\r\n                    break;\r\n                default:\r\n                    iconUrl = __uri('/static/images/carrunnorth.png');\r\n                    break;\r\n            }\r\n        } else {\r\n            height = 22;\r\n            width = 27;\r\n            switch (status) {\r\n                case '离线':\r\n                    iconUrl = __uri('/static/images/othertypeoffline.png');\r\n                    break;\r\n                case '静止':\r\n                    iconUrl = __uri('/static/images/othertypestatic.png');\r\n                    break;\r\n                default:\r\n                    iconUrl = __uri('/static/images/othertype.png');\r\n                    break;\r\n            }\r\n        }\r\n        img.src = iconUrl;\r\n        img.style.width = width;\r\n        img.style.height = height;\r\n        return img;\r\n    },\r\n\r\n    /**\r\n     * 删除设备监控的marker,\r\n     *\r\n     */\r\n    removeEntityMarker() {\r\n        map.removeOverlay(this.entityMarker);\r\n        this.entityMarker = null;\r\n    },\r\n\r\n    /**\r\n     * 初始化车辆信息详情和轨迹点详情infobox\r\n     *\r\n     * @param {Object} data 数据\r\n     */\r\n    setTrackInfoBox(data) {\r\n        // console.log(data);\r\n        let infoContentFrontArr = [\r\n            '<div class=\"carInfoWindow\">',\r\n                '<div class=\"carInfoHeader0\">',\r\n                    '<abbr title=\"' + data.print + '\">',\r\n                    data.print,\r\n                    '</abbr>',\r\n                '</div>',\r\n                '<div class=\"carInfoContent\">'\r\n        ];\r\n        data.infor.map(function (item) {\r\n            let itemPushArr = [\r\n                '<div class=\"carInfoItem\">',\r\n                    '<div class=\"infoItemTitle\">',\r\n                        item[0],\r\n                    '</div>',\r\n                    '<div class=\"infoItemContent\">',\r\n                        item[1],\r\n                    '</div>',\r\n                '</div>'\r\n            ];\r\n            infoContentFrontArr.push(itemPushArr.join(''));\r\n        });\r\n        let infoContentNextArr = [\r\n            '</div>',\r\n            '<div class=\"infoControl\">',\r\n                '<div class=\"infoZoomIn\" id=\"trackInfoZoomIn\">',\r\n                    '放大',\r\n                '</div>',\r\n            '</div>',\r\n            '</div>'\r\n        ];\r\n        // return;\r\n\r\n        this.trackInfoBox = new BMapLib.InfoBox(\r\n            map,\r\n            infoContentFrontArr.concat(infoContentNextArr).join(''),\r\n            {\r\n                boxClass:'carInfoBox',\r\n                closeIconMargin: '15px 20px 0 0',\r\n                alignBottom: false,\r\n                closeIconUrl: __uri('/static/images/closeinfowindow.png')\r\n            }\r\n        );\r\n        this.trackInfoBox.open(data.point);\r\n        $('#trackInfoZoomIn').click(function (e) {\r\n            // this.trackInfoBox.hide();\r\n            map.zoomIn();\r\n            map.addEventListener('moveend', function () {\r\n                // that.trackInfoBox.show();\r\n            });\r\n        });\r\n        // this.trackInfoBox.addEventListener('close', this.removeTrackPointOverlay('trackpointonOverlay'));\r\n        map.panTo(data.point);\r\n    },\r\n\r\n    /**\r\n     * 删除infobox\r\n     *\r\n     */\r\n    removeTrackInfoBox() {\r\n        map.removeOverlay(this.trackInfoBox);\r\n        this.trackInfoBox = null;\r\n    },\r\n\r\n    /**\r\n     * 设置boundsearch展示\r\n     *\r\n     * @param {Array} markerArr 展示数据\r\n     * @param {Object} MarkerOption 数据样式\r\n     */\r\n    setBoundSearch(markerArr, MarkerOption) {\r\n        let overlays = map.getOverlays();\r\n        if (window.dataSet && window.mapvLayer && overlays.length !== 0) {\r\n\r\n            window.dataSet.set(markerArr);\r\n        } else {\r\n            window.dataSet = new mapv.DataSet(markerArr);\r\n            let options = {\r\n\r\n                methods: {\r\n                    click(item) {\r\n                        if (item === null) {\r\n                            return;\r\n                        }\r\n                        TrackAction.selectcar(item.entity_name, item.entity_status, '');\r\n                    }\r\n                },\r\n                size: 20,\r\n                draw: 'icon',\r\n                height: MarkerOption.height,\r\n                width: MarkerOption.width\r\n            };\r\n            window.mapvLayer = new mapv.baiduMapLayer(map, dataSet, options);\r\n        }\r\n    }\r\n}\r\n\r\n"]}